# 商品表單功能增強 - 開發需求文件

## 📋 需求概述

在現有的商品表單 (`ProductForm.tsx`) 中新增代理商選擇功能，並重新設計商品標籤的選擇介面，以提供更好的使用者體驗。

## 🎯 功能需求

### 1. 代理商選擇功能
- 新增代理商下拉選單，讓使用者可以選擇商品的供應商
- 使用 `useGetSupplierAll` hook 獲取所有代理商資料
- 支援單選模式

### 2. 商品標籤多選功能重構
- 移除現有的兩個固定標籤輸入欄位
- 新增多選標籤下拉選單
- 使用 `useGetAllTags` hook 獲取所有可用標籤
- 實作新的 UI/UX 流程：
  - 顯示「新增標籤」按鈕
  - 點擊按鈕後顯示標籤下拉選單
  - 支援多選標籤
  - 顯示已選擇的標籤列表
  - 每個已選標籤都有移除功能

### 3. 資料結構更新
更新表單提交的資料格式：
```typescript
{
  "supplier_id": ["string"],  // 代理商 ID 陣列
  "tag_id": ["string"]       // 標籤 ID 陣列
}
```

### 4. 編輯模式相容性
- 確保編輯商品時能正確載入並顯示已選擇的代理商和標籤
- 保持表單資料的一致性

## 🔧 技術實作細節

### 使用的 Hooks
1. `useGetSupplierAll` - 從 `@/pages/suppliers/hooks/use-supplier.ts`
2. `useGetAllTags` - 從 `@/pages/tags/hooks/use-tag.ts`

### UI 元件
- 使用現有的 `Select` 元件實作下拉選單
- 可能需要使用 `MultiSelect` 或類似元件實作多選功能
- 使用 `Badge` 或類似元件顯示已選擇的標籤

### 表單整合
- 更新 `TProductForm` 類型定義
- 修改表單驗證 schema
- 更新資料轉換邏輯

## 📝 開發階段

### Phase 1: 創建開發需求文件 ✓
- 定義功能需求
- 規劃技術方案

### Phase 2: 分析現有程式碼結構
- 研究現有表單結構
- 確認需要修改的部分
- 評估影響範圍

### Phase 3: 實作代理商下拉選單
- 引入 `useGetSupplierAll` hook
- 新增代理商選單 UI
- 整合到表單中

### Phase 4: 實作商品標籤多選功能
- 引入 `useGetAllTags` hook
- 移除現有標籤輸入欄位
- 實作新的多選標籤 UI

### Phase 5: 更新表單資料結構
- 修改表單 schema
- 更新提交邏輯
- 確保資料格式正確

### Phase 6: 處理編輯模式
- 確保編輯時正確載入資料
- 處理初始值設定

### Phase 7: 測試與驗證
- 測試創建商品功能
- 測試編輯商品功能
- 驗證資料提交格式

## ⚠️ 注意事項

1. 遵循現有的程式碼風格和命名慣例
2. 確保所有文字都支援多語言 (i18n)
3. 保持表單驗證的完整性
4. 處理載入狀態和錯誤情況
5. 遵循 CLAUDE.md 中的 commit 規則

## 🚀 預期成果

完成後，商品表單將具備：
1. 代理商選擇功能
2. 更直覺的標籤多選介面
3. 更好的使用者體驗
4. 支援新的資料格式要求